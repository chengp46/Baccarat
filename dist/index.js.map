{
  "version": 3,
  "sources": ["../src/utils/WsClient.js", "../src/index.js"],
  "sourcesContent": ["export class WSClient {\r\n    constructor(url) {\r\n        this.url = url;\r\n        this.ws = null;\r\n        this.heartTimer = null;\r\n        this.reconnectTimer = null;\r\n        this.reconnectDelay = 3000;\r\n    }\r\n\r\n    connect() {\r\n        if (this.ws) return;\r\n\r\n        this.ws = new WebSocket(this.url);\r\n\r\n        this.ws.onopen = () => {\r\n            console.log(\"WS connected\");\r\n            this.startHeartBeat();\r\n        };\r\n\r\n        this.ws.onmessage = (e) => {\r\n            console.log(\"WS message:\", e.data);\r\n        };\r\n\r\n        this.ws.onerror = () => {\r\n            console.log(\"WS error\");\r\n        };\r\n\r\n        this.ws.onclose = () => {\r\n            console.log(\"WS closed\");\r\n            this.stopHeartBeat();\r\n            this.ws = null;\r\n            this.reconnect();\r\n        };\r\n    }\r\n\r\n    // \u53D1\u9001\u6570\u636E\r\n    send(data) {\r\n        if (this.ws && this.ws.readyState === WebSocket.OPEN) {\r\n            this.ws.send(\r\n                typeof data === \"string\" ? data : JSON.stringify(data)\r\n            );\r\n        }\r\n    }\r\n\r\n    startHeartBeat() {\r\n        this.heartTimer = setInterval(() => {\r\n            this.send({ cmd: \"ping\" });\r\n        }, 5000);\r\n    }\r\n\r\n    stopHeartBeat() {\r\n        clearInterval(this.heartTimer);\r\n        this.heartTimer = null;\r\n    }\r\n\r\n    reconnect() {\r\n        if (this.reconnectTimer) return;\r\n\r\n        this.reconnectTimer = setTimeout(() => {\r\n            console.log(\"WS reconnecting...\");\r\n            this.reconnectTimer = null;\r\n            this.connect();\r\n        }, this.reconnectDelay);\r\n    }\r\n\r\n    close() {\r\n        this.stopHeartBeat();\r\n        this.ws && this.ws.close();\r\n        this.ws = null;\r\n    }\r\n}", "import { WSClient } from \"./utils/WsClient.js\";\r\n\r\nclass App {\r\n    constructor() {\r\n        this.init();\r\n    }\r\n\r\n    init() {\r\n        this.ws = new WSClient(\"\");\r\n    }\r\n\r\n    run() {\r\n\r\n    }\r\n}\r\n\r\nlet app = new App();\r\napp.run();"],
  "mappings": ";AAAO,IAAM,WAAN,MAAe;AAAA,EAClB,YAAY,KAAK;AACb,SAAK,MAAM;AACX,SAAK,KAAK;AACV,SAAK,aAAa;AAClB,SAAK,iBAAiB;AACtB,SAAK,iBAAiB;AAAA,EAC1B;AAAA,EAEA,UAAU;AACN,QAAI,KAAK,GAAI;AAEb,SAAK,KAAK,IAAI,UAAU,KAAK,GAAG;AAEhC,SAAK,GAAG,SAAS,MAAM;AACnB,cAAQ,IAAI,cAAc;AAC1B,WAAK,eAAe;AAAA,IACxB;AAEA,SAAK,GAAG,YAAY,CAAC,MAAM;AACvB,cAAQ,IAAI,eAAe,EAAE,IAAI;AAAA,IACrC;AAEA,SAAK,GAAG,UAAU,MAAM;AACpB,cAAQ,IAAI,UAAU;AAAA,IAC1B;AAEA,SAAK,GAAG,UAAU,MAAM;AACpB,cAAQ,IAAI,WAAW;AACvB,WAAK,cAAc;AACnB,WAAK,KAAK;AACV,WAAK,UAAU;AAAA,IACnB;AAAA,EACJ;AAAA;AAAA,EAGA,KAAK,MAAM;AACP,QAAI,KAAK,MAAM,KAAK,GAAG,eAAe,UAAU,MAAM;AAClD,WAAK,GAAG;AAAA,QACJ,OAAO,SAAS,WAAW,OAAO,KAAK,UAAU,IAAI;AAAA,MACzD;AAAA,IACJ;AAAA,EACJ;AAAA,EAEA,iBAAiB;AACb,SAAK,aAAa,YAAY,MAAM;AAChC,WAAK,KAAK,EAAE,KAAK,OAAO,CAAC;AAAA,IAC7B,GAAG,GAAI;AAAA,EACX;AAAA,EAEA,gBAAgB;AACZ,kBAAc,KAAK,UAAU;AAC7B,SAAK,aAAa;AAAA,EACtB;AAAA,EAEA,YAAY;AACR,QAAI,KAAK,eAAgB;AAEzB,SAAK,iBAAiB,WAAW,MAAM;AACnC,cAAQ,IAAI,oBAAoB;AAChC,WAAK,iBAAiB;AACtB,WAAK,QAAQ;AAAA,IACjB,GAAG,KAAK,cAAc;AAAA,EAC1B;AAAA,EAEA,QAAQ;AACJ,SAAK,cAAc;AACnB,SAAK,MAAM,KAAK,GAAG,MAAM;AACzB,SAAK,KAAK;AAAA,EACd;AACJ;;;ACpEA,IAAM,MAAN,MAAU;AAAA,EACN,cAAc;AACV,SAAK,KAAK;AAAA,EACd;AAAA,EAEA,OAAO;AACH,SAAK,KAAK,IAAI,SAAS,EAAE;AAAA,EAC7B;AAAA,EAEA,MAAM;AAAA,EAEN;AACJ;AAEA,IAAI,MAAM,IAAI,IAAI;AAClB,IAAI,IAAI;",
  "names": []
}
